list(APPEND external_libraries ${ZLIB_LIBRARIES} ${Boost_SYSTEM_LIBRARY} ${Boost_TIMER_LIBRARY} ${Boost_CHRONO_LIBRARY})
add_executable(update_reference_files.x update_reference_files.cpp)
target_link_libraries(update_reference_files.x pcm "${external_libraries}")

configure_file(bi_operators_collocation.cpp.in ${CMAKE_CURRENT_LIST_DIR}/bi_operators_collocation.cpp @ONLY)
set_property(GLOBAL APPEND PROPERTY TestSources ${CMAKE_CURRENT_LIST_DIR}/bi_operators_collocation.cpp)
add_test(NAME bi_operators_collocation COMMAND unit_tests.x [bi_operators_collocation])

add_reference(vacuum_S_collocation.npy ${TESTS_ROOT_DIRECTORY})
add_reference(vacuum_D_collocation.npy ${TESTS_ROOT_DIRECTORY})
add_reference(uniformdielectric_S_collocation.npy ${TESTS_ROOT_DIRECTORY})
add_reference(uniformdielectric_D_collocation.npy ${TESTS_ROOT_DIRECTORY})
add_reference(tanhsphericaldiffuse_S_collocation.npy ${TESTS_ROOT_DIRECTORY})
add_reference(tanhsphericaldiffuse_D_collocation.npy ${TESTS_ROOT_DIRECTORY})

configure_file(bi_operators_numerical.cpp.in ${CMAKE_CURRENT_LIST_DIR}/bi_operators_numerical.cpp @ONLY)
set_property(GLOBAL APPEND PROPERTY TestSources ${CMAKE_CURRENT_LIST_DIR}/bi_operators_numerical.cpp)
add_test(NAME bi_operators_numerical COMMAND unit_tests.x [bi_operators_numerical])
#add_reference(vacuum_S_numerical.npy ${TESTS_ROOT_DIRECTORY})
#add_reference(vacuum_D_numerical.npy ${TESTS_ROOT_DIRECTORY})
#add_reference(uniformdielectric_S_numerical.npy ${TESTS_ROOT_DIRECTORY})
#add_reference(uniformdielectric_D_numerical.npy ${TESTS_ROOT_DIRECTORY})
#add_reference(ionic_S_numerical.npy ${TESTS_ROOT_DIRECTORY})
#add_reference(ionic_D_numerical.npy ${TESTS_ROOT_DIRECTORY})
#add_reference(anisotropic_S_numerical.npy ${TESTS_ROOT_DIRECTORY})
#add_reference(anisotropic_D_numerical.npy ${TESTS_ROOT_DIRECTORY})
